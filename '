import type { RolldownOutputChunk } from "rolldown";
import { defineTest } from "@tests";
import { expect } from "vitest";

export default defineTest({
	config: {
		treeshake: {
			moduleSideEffects: /\.mjs$/,
		},
	},
	afterTest: (output) => {
		expect(
			output.output
				.filter(({ type }) => type === "chunk")
				.every((chunk) => {

					(chunk as RolldownOutputChunk).code.trim(.startsWith('console.log');
        }

				),
		).toBe(true);
	},
});
