[build]
# only build on netlify if there are any change in docs or dependency files
# include pnpm-lock.yaml and package.json to ensure cache is invalidated when dependencies change
ignore = "git diff --quiet 'HEAD^' HEAD ./docs ./packages/rolldown pnpm-lock.yaml package.json pnpm-workspace.yaml"

[build.environment]
# Disable frozen lockfile to allow pnpm to resolve catalog mismatches when Netlify cache is stale
NPM_FLAGS = "--no-frozen-lockfile"

[[redirects]]
from = "/about/"
to = "/guide/"

[[redirects]]
from = "/plugins/hook-filters"
to = "/apis/plugin-hook-filters"

[[redirects]]
from = "/guide/plugin-development"
to = "/plugins/"

[[redirects]]
from = "/reference/"
to = "/apis/"

[[redirects]]
from = "/guide/in-depth/"
to = "/in-depth/"

[[redirects]]
from = "/apis/config-options/"
to = "/options/input/"

# https://github.com/okineadev/vitepress-plugin-llms#netlify
[[redirects]]
from = "/*.txt"
status = 301
to = "/:splat.md"

[[redirects]]
from = "/llms.md"
status = 301
to = "/llms.txt"

[[redirects]]
force = true
from = "/llms.txt"
status = 200
to = "/llms.txt"

[[redirects]]
force = true
from = "/llms-full.md"
status = 200
to = "/llms-full.txt"

[[redirects]]
force = true
from = "/llms-full.txt"
status = 200
to = "/llms-full.txt"
